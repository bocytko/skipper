
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://opensource.zalando.com/skipper/reference/predicates/">
      
      <link rel="shortcut icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.4">
    
    
      
        <title>Predicates - Skipper</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#skipper-predicates" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://opensource.zalando.com/skipper/" title="Skipper" class="md-header-nav__button md-logo" aria-label="Skipper">
      
  <img src="../../skipper-h180.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Skipper
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Predicates
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/zalando/skipper/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://opensource.zalando.com/skipper/" title="Skipper" class="md-nav__button md-logo" aria-label="Skipper">
      
  <img src="../../skipper-h180.png" alt="logo">

    </a>
    Skipper
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/zalando/skipper/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      



  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  


  
  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Reference
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reference" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Reference
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../filters/" class="md-nav__link">
      Filters
    </a>
  </li>

        
          
          
          


  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Predicates
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Predicates
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#predicate-arguments" class="md-nav__link">
    Predicate arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-path-tree" class="md-nav__link">
    The path tree
  </a>
  
    <nav class="md-nav" aria-label="The path tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path" class="md-nav__link">
    Path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathsubtree" class="md-nav__link">
    PathSubtree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathregexp" class="md-nav__link">
    PathRegexp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#host" class="md-nav__link">
    Host
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hostany" class="md-nav__link">
    HostAny
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forwarded-header-predicates" class="md-nav__link">
    Forwarded header predicates
  </a>
  
    <nav class="md-nav" aria-label="Forwarded header predicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forwardedhost" class="md-nav__link">
    ForwardedHost
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forwardedprotocol" class="md-nav__link">
    ForwardedProtocol
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weight" class="md-nav__link">
    Weight
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#true" class="md-nav__link">
    True
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#false" class="md-nav__link">
    False
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shutdown" class="md-nav__link">
    Shutdown
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#method" class="md-nav__link">
    Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#header" class="md-nav__link">
    Header
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#headerregexp" class="md-nav__link">
    HeaderRegexp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookie" class="md-nav__link">
    Cookie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auth" class="md-nav__link">
    Auth
  </a>
  
    <nav class="md-nav" aria-label="Auth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jwtpayloadanykv" class="md-nav__link">
    JWTPayloadAnyKV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwtpayloadallkv" class="md-nav__link">
    JWTPayloadAllKV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwtpayloadanykvregexp-jwtpayloadallkvregexp" class="md-nav__link">
    JWTPayloadAnyKVRegexp, JWTPayloadAllKVRegexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headersha256" class="md-nav__link">
    HeaderSHA256
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interval" class="md-nav__link">
    Interval
  </a>
  
    <nav class="md-nav" aria-label="Interval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#after" class="md-nav__link">
    After
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before" class="md-nav__link">
    Before
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#between" class="md-nav__link">
    Between
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cron" class="md-nav__link">
    Cron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryparam" class="md-nav__link">
    QueryParam
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source" class="md-nav__link">
    Source
  </a>
  
    <nav class="md-nav" aria-label="Source">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sourcefromlast" class="md-nav__link">
    SourceFromLast
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clientip" class="md-nav__link">
    ClientIP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tee" class="md-nav__link">
    Tee
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic" class="md-nav__link">
    Traffic
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../backends/" class="md-nav__link">
      Backends
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../egress/" class="md-nav__link">
      Egress
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../scripts/" class="md-nav__link">
      Scripts
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../plugins/" class="md-nav__link">
      Plugins
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../architecture/" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../development/" class="md-nav__link">
      Development
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/video-howto-build/" class="md-nav__link">
      Video - How to build
    </a>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10" >
    
    <label class="md-nav__link" for="nav-2-10">
      Data Clients
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Data Clients" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        <span class="md-nav__icon md-icon"></span>
        Data Clients
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../data-clients/eskip-file/" class="md-nav__link">
      Eskip File
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../data-clients/eskip-remote/" class="md-nav__link">
      Remote Eskip
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../data-clients/route-string/" class="md-nav__link">
      Route String
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../data-clients/kubernetes/" class="md-nav__link">
      Kubernetes
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../data-clients/etcd/" class="md-nav__link">
      Etcd
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-11" type="checkbox" id="nav-2-11" >
    
    <label class="md-nav__link" for="nav-2-11">
      Operation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Operation" data-md-level="2">
      <label class="md-nav__title" for="nav-2-11">
        <span class="md-nav__icon md-icon"></span>
        Operation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../operation/deployment/" class="md-nav__link">
      Deployment
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../operation/operation/" class="md-nav__link">
      Operation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    
    <label class="md-nav__link" for="nav-3">
      Kubernetes
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Kubernetes" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Kubernetes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/ingress-controller/" class="md-nav__link">
      Ingress Controller Deployment
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/ingress-usage/" class="md-nav__link">
      Ingress Usage
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/ingress-backends/" class="md-nav__link">
      Ingress Backends
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/routegroups/" class="md-nav__link">
      RouteGroups
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/routegroup-crd/" class="md-nav__link">
      RouteGroup CRD Semantics
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/routegroup-validation/" class="md-nav__link">
      RouteGroup Validation
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/east-west-usage/" class="md-nav__link">
      East-West aka svc-to-svc
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../kubernetes/external-addresses/" class="md-nav__link">
      External Addresses aka External Name
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      



  
  <li class="md-nav__item md-nav__item--nested">
    
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
    
    <label class="md-nav__link" for="nav-4">
      Tutorials
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/basics/" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/common-use-cases/" class="md-nav__link">
      Common Use Cases
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/auth/" class="md-nav__link">
      Authentication and Autorization
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/ratelimit/" class="md-nav__link">
      Ratelimits
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/shadow-traffic/" class="md-nav__link">
      Shadow Traffic
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/operations/" class="md-nav__link">
      Operations
    </a>
  </li>

        
          
          
          



  <li class="md-nav__item">
    <a href="../../tutorials/development/" class="md-nav__link">
      Development
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#predicate-arguments" class="md-nav__link">
    Predicate arguments
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-path-tree" class="md-nav__link">
    The path tree
  </a>
  
    <nav class="md-nav" aria-label="The path tree">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#path" class="md-nav__link">
    Path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathsubtree" class="md-nav__link">
    PathSubtree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pathregexp" class="md-nav__link">
    PathRegexp
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#host" class="md-nav__link">
    Host
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hostany" class="md-nav__link">
    HostAny
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forwarded-header-predicates" class="md-nav__link">
    Forwarded header predicates
  </a>
  
    <nav class="md-nav" aria-label="Forwarded header predicates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forwardedhost" class="md-nav__link">
    ForwardedHost
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forwardedprotocol" class="md-nav__link">
    ForwardedProtocol
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weight" class="md-nav__link">
    Weight
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#true" class="md-nav__link">
    True
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#false" class="md-nav__link">
    False
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shutdown" class="md-nav__link">
    Shutdown
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#method" class="md-nav__link">
    Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#header" class="md-nav__link">
    Header
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#headerregexp" class="md-nav__link">
    HeaderRegexp
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookie" class="md-nav__link">
    Cookie
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#auth" class="md-nav__link">
    Auth
  </a>
  
    <nav class="md-nav" aria-label="Auth">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jwtpayloadanykv" class="md-nav__link">
    JWTPayloadAnyKV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwtpayloadallkv" class="md-nav__link">
    JWTPayloadAllKV
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwtpayloadanykvregexp-jwtpayloadallkvregexp" class="md-nav__link">
    JWTPayloadAnyKVRegexp, JWTPayloadAllKVRegexp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headersha256" class="md-nav__link">
    HeaderSHA256
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interval" class="md-nav__link">
    Interval
  </a>
  
    <nav class="md-nav" aria-label="Interval">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#after" class="md-nav__link">
    After
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#before" class="md-nav__link">
    Before
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#between" class="md-nav__link">
    Between
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cron" class="md-nav__link">
    Cron
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#queryparam" class="md-nav__link">
    QueryParam
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source" class="md-nav__link">
    Source
  </a>
  
    <nav class="md-nav" aria-label="Source">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sourcefromlast" class="md-nav__link">
    SourceFromLast
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clientip" class="md-nav__link">
    ClientIP
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tee" class="md-nav__link">
    Tee
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traffic" class="md-nav__link">
    Traffic
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/zalando/skipper/edit/master/docs/reference/predicates.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="skipper-predicates">Skipper Predicates<a class="headerlink" href="#skipper-predicates" title="Permanent link">&para;</a></h1>
<p>Predicates are used to decide which route will handle an incoming request. Routes can contain multiple
predicates. A request will match a route only if all the predicates of the route match. See the description of
the route matching mechanism here: <a href="../../tutorials/basics/#route-matching">Route matching</a>.</p>
<p>Example route with a Host, Method and Path match predicates and a backend:</p>
<div class="highlight"><pre><span></span><code>all: Host(/^my-host-header\.example\.org$/) &amp;&amp; Method(&quot;GET&quot;) &amp;&amp; Path(&quot;/hello&quot;) -&gt; &quot;http://127.0.0.1:1234/&quot;;
</code></pre></div>
<h2 id="predicate-arguments">Predicate arguments<a class="headerlink" href="#predicate-arguments" title="Permanent link">&para;</a></h2>
<p>The predicate arguments can be strings, regular expressions or numbers (float64, int). In the eskip syntax
representation:</p>
<ul>
<li>strings are surrounded by double quotes (<code>"</code>). When necessary, characters can be escaped by <code>\</code>, e.g. <code>\\</code> or <code>\"</code>.</li>
<li>regular expressions are a <a href="https://github.com/google/re2/wiki/Syntax">re2 regular expression</a>, surrounded by</li>
<li><code>/</code>, e.g. <code>/^www\.example\.org(:\d+)?$/</code>. When a predicate expects a regular expression as an argument, the string representation with double quotes can be used, as well.</li>
<li>numbers are regular (decimal) numbers like <code>401</code> or <code>1.23456</code>. The eskip syntax doesn&rsquo;t define a limitation on the size of the numbers, but the underlying implementation currently relies on the float64 values of the Go runtime.</li>
</ul>
<p>Other higher level argument types must be represented as one of the above types. E.g. it is a convention to
represent time duration values as strings, parseable by <a href="https://godoc.org/time#ParseDuration">time.Duration</a>).</p>
<h2 id="the-path-tree">The path tree<a class="headerlink" href="#the-path-tree" title="Permanent link">&para;</a></h2>
<p>There is an important difference between the evaluation of the <a href="#path">Path</a> or <a href="#pathsubtree">PathSubtree</a> predicates, and the
evaluation of all the other predicates (<a href="#pathregexp">PathRegexp</a> belonging to the second group). Find an explanation in the
<a href="../../tutorials/basics/#route-matching">Route matching</a> section explanation section.</p>
<h3 id="path">Path<a class="headerlink" href="#path" title="Permanent link">&para;</a></h3>
<p>The path predicate is used to match the path in HTTP request line. It accepts a single argument, that can be a
fixed path like &ldquo;/some/path&rdquo;, or it can contain wildcards. There can be only zero or one path predicate in a
route.</p>
<p><strong>Wildcards:</strong></p>
<p>Wildcards can be put in place of one or more path segments in the path, e.g. &ldquo;/some/:dir/:name&rdquo;, or the path can
end with a free wildcard like <code>"/some/path/*param"</code>, where the free wildcard can match against a sub-path with
multiple segments. Note, that this solution implicitly supports the glob standard, e.g. <code>"/some/path/**"</code> will
work as expected. The wildcards must follow a <code>/</code>.</p>
<p>The arguments are available to the filters while processing the matched requests, but
currently only a few built-in filters utilize them, and they can be used rather only from custom filter
extensions.</p>
<p><strong>Known bug:</strong></p>
<p>There is a known bug with how predicates of the form <code>Path("/foo/*")</code> are currently handled. Note the wildcard
defined with <code>*</code> doesn&rsquo;t have a name here. Wildcards must have a name, but Skipper currently does not reject
these routes, resulting in undefined behavior.</p>
<p><strong>Trailing slash:</strong></p>
<p>By default, <code>Path("/foo")</code> and <code>Path("/foo/")</code> are not equivalent. Ignoring the trailing slash can be toggled
with the <code>-ignore-trailing-slash</code> command line flag.</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code>Path(&quot;/foo/bar&quot;)     //   /foo/bar
Path(&quot;/foo/bar/&quot;)    //   /foo/bar/, unless started with -ignore-trailing-slash
Path(&quot;/foo/:id&quot;)     //   /foo/_anything
Path(&quot;/foo/:id/baz&quot;) //   /foo/_anything/baz
Path(&quot;/foo/*rest&quot;)   //   /foo/bar/baz
Path(&quot;/foo/**&quot;)      //   /foo/bar/baz
</code></pre></div>
<h3 id="pathsubtree">PathSubtree<a class="headerlink" href="#pathsubtree" title="Permanent link">&para;</a></h3>
<p>The path subtree predicate behaves similar to the path predicate, but it matches the exact path in the
definition and any sub path below it. The subpath is automatically provided among the path parameters with the
name <code>*</code>. If a free wildcard is appended to the definition, e.g. <code>PathSubtree("/some/path/*rest")</code>, the free
wildcard name is used instead of <code>*</code>. The simple wildcards behave similar to the Path predicate. The main
difference between <code>PathSubtree("/foo")</code> and <code>Path("/foo/**")</code> is that the PathSubtree predicate always ignores
the trailing slashes.</p>
<p><strong>Examples:</strong></p>
<div class="highlight"><pre><span></span><code>PathSubtree(&quot;/foo/bar&quot;)
PathSubtree(&quot;/&quot;)
PathSubtree(&quot;/foo/*rest&quot;)
</code></pre></div>
<h3 id="pathregexp">PathRegexp<a class="headerlink" href="#pathregexp" title="Permanent link">&para;</a></h3>
<p>Regular expressions to match the path. It uses Go&rsquo;s standard library
regexp package to match, which is based on
<a href="https://github.com/google/re2/wiki/Syntax">re2 regular expression syntax</a>.</p>
<p>Parameters:</p>
<ul>
<li>PathRegexp (regex)</li>
</ul>
<p>A route can contain more than one PathRegexp predicates. It can be also used in combination with the Path
predicate.</p>
<div class="highlight"><pre><span></span><code>Path(&quot;/colors/:name/rgb-value&quot;) &amp;&amp; PathRegexp(&quot;^/colors/(red|green|blue|cyan|magenta|pink|yellow)/&quot;)
-&gt; returnRGB()
-&gt; &lt;shunt&gt;
</code></pre></div>
<p>Further examples:</p>
<div class="highlight"><pre><span></span><code>PathRegexp(&quot;^/foo/bar&quot;)
PathRegexp(&quot;/foo/bar$&quot;)
PathRegexp(&quot;/foo/bar/&quot;)
PathRegexp(&quot;^/foo/(bar|qux)&quot;)
</code></pre></div>
<h2 id="host">Host<a class="headerlink" href="#host" title="Permanent link">&para;</a></h2>
<p>Regular expressions that the host header in the request must match.</p>
<p>Parameters:</p>
<ul>
<li>Host (regex)</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>Host(/^my-host-header\.example\.org$/)
Host(/header\.example\.org$/)
</code></pre></div>
<h2 id="hostany">HostAny<a class="headerlink" href="#hostany" title="Permanent link">&para;</a></h2>
<p>Evaluates to true if request host exactly equals to any of the configured hostnames.</p>
<p>Parameters:</p>
<ul>
<li>hostnames (string)</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>HostAny(&quot;www.example.org&quot;, &quot;www.example.com&quot;)
HostAny(&quot;localhost:9090&quot;)
</code></pre></div>
<h2 id="forwarded-header-predicates">Forwarded header predicates<a class="headerlink" href="#forwarded-header-predicates" title="Permanent link">&para;</a></h2>
<p>Uses standardized Forwarded header (<a href="https://tools.ietf.org/html/rfc7239">RFC 7239</a>)</p>
<p>More info about the header: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Forwarded">MDN</a></p>
<p>If multiple proxies chain values in the header, as a comma separated list, the predicates below will only match
the last value in the chain for each part of the header.</p>
<p>Example: Forwarded: host=example.com;proto=https, host=example.org</p>
<ul>
<li><code>ForwardedHost(/^example\.com$/)</code> - does not match</li>
<li><code>ForwardedHost(/^example\.org$/)</code> - matches</li>
<li><code>ForwardedHost(/^example\.org$/) &amp;&amp; ForwardedProto("https")</code> - matches</li>
<li><code>ForwardedHost(/^example\.com$/) &amp;&amp; ForwardedProto("https")</code> - does not match</li>
</ul>
<h3 id="forwardedhost">ForwardedHost<a class="headerlink" href="#forwardedhost" title="Permanent link">&para;</a></h3>
<p>Regular expressions that the forwarded host header in the request must match.</p>
<p>Parameters:</p>
<ul>
<li>Host (regex)</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>ForwardedHost(/^my-host-header\.example\.org$/)
ForwardedHost(/header\.example\.org$/)
</code></pre></div>
<h3 id="forwardedprotocol">ForwardedProtocol<a class="headerlink" href="#forwardedprotocol" title="Permanent link">&para;</a></h3>
<p>Protocol the forwarded header in the request must match.</p>
<p>Parameters:</p>
<ul>
<li>Protocol (string)</li>
</ul>
<p>Only &ldquo;http&rdquo; and &ldquo;https&rdquo; values are allowed</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>ForwardedProtocol(&quot;http&quot;)
ForwardedProtocol(&quot;https&quot;)
</code></pre></div>
<h2 id="weight">Weight<a class="headerlink" href="#weight" title="Permanent link">&para;</a></h2>
<p>By default, the weight (priority) of a route is determined by the number of defined predicates.</p>
<p>If you want to give a route more priority, you can give it more weight.</p>
<p>Parameters:</p>
<ul>
<li>Weight (int)</li>
</ul>
<p>Example where <code>route2</code> has more priority because it has more predicates:</p>
<div class="highlight"><pre><span></span><code>route1: Path(&quot;/test&quot;) -&gt; &quot;http://www.zalando.de&quot;;
route2: Path(&quot;/test&quot;) &amp;&amp; True() -&gt; &quot;http://www.zalando.de&quot;;
</code></pre></div>
<p>Example where <code>route1</code> has more priority because it has more weight:</p>
<div class="highlight"><pre><span></span><code>route1: Path(&quot;/test&quot;) &amp;&amp; Weight(100) -&gt; &quot;http://www.zalando.de&quot;;
route2: Path(&quot;/test&quot;) &amp;&amp; True() &amp;&amp; True() -&gt; &quot;http://www.zalando.de&quot;;
</code></pre></div>
<h2 id="true">True<a class="headerlink" href="#true" title="Permanent link">&para;</a></h2>
<p>Does always match. Before <code>Weight</code> predicate existed this was used to give a route more weight.</p>
<p>Example where <code>route2</code> has more weight.</p>
<div class="highlight"><pre><span></span><code>route1: Path(&quot;/test&quot;) -&gt; &quot;http://www.zalando.de&quot;;
route2: Path(&quot;/test&quot;) &amp;&amp; True() -&gt; &quot;http://www.github.com&quot;;
</code></pre></div>
<h2 id="false">False<a class="headerlink" href="#false" title="Permanent link">&para;</a></h2>
<p>Does not match. Can be used to disable certain routes.</p>
<p>Example where <code>route2</code> is disabled.</p>
<div class="highlight"><pre><span></span><code>route1: Path(&quot;/test&quot;) -&gt; &quot;http://www.zalando.de&quot;;
route2: Path(&quot;/test&quot;) &amp;&amp; False() -&gt; &quot;http://www.github.com&quot;;
</code></pre></div>
<h2 id="shutdown">Shutdown<a class="headerlink" href="#shutdown" title="Permanent link">&para;</a></h2>
<p>Evaluates to true if Skipper is shutting down. Can be used to create customized healthcheck.</p>
<div class="highlight"><pre><span></span><code>health_up: Path(&quot;/health&quot;) -&gt; inlineContent(&quot;OK&quot;) -&gt; &lt;shunt&gt;;
health_down: Path(&quot;/health&quot;) &amp;&amp; Shutdown() -&gt; status(503) -&gt; inlineContent(&quot;shutdown&quot;) -&gt; &lt;shunt&gt;;
</code></pre></div>
<h2 id="method">Method<a class="headerlink" href="#method" title="Permanent link">&para;</a></h2>
<p>The HTTP method that the request must match. HTTP methods are one of
GET, HEAD, PATCH, POST, PUT, DELETE, OPTIONS, CONNECT.</p>
<p>Parameters:</p>
<ul>
<li>Method (string)</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>Method(&quot;GET&quot;)
Method(&quot;OPTIONS&quot;)
</code></pre></div>
<h2 id="methods">Methods<a class="headerlink" href="#methods" title="Permanent link">&para;</a></h2>
<p>The HTTP method that the request must match. HTTP methods are one of
GET, HEAD, PATCH, POST, PUT, DELETE, OPTIONS, CONNECT, TRACE.</p>
<p>Parameters:</p>
<ul>
<li>Method (&hellip;string) methods names</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>Methods(&quot;GET&quot;)
Methods(&quot;OPTIONS&quot;, &quot;POST&quot;)
Methods(&quot;OPTIONS&quot;, &quot;POST&quot;, &quot;patch&quot;)
</code></pre></div>
<h2 id="header">Header<a class="headerlink" href="#header" title="Permanent link">&para;</a></h2>
<p>A header key and exact value that must be present in the request. Note
that Header(&ldquo;Key&rdquo;, &ldquo;Value&rdquo;) is equivalent to HeaderRegexp(&ldquo;Key&rdquo;, &ldquo;^Value$&rdquo;).</p>
<p>Parameters:</p>
<ul>
<li>Header (string, string)</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>Header(&quot;X-Forwarded-For&quot;, &quot;192.168.0.2&quot;)
Header(&quot;Accept&quot;, &quot;application/json&quot;)
</code></pre></div>
<h2 id="headerregexp">HeaderRegexp<a class="headerlink" href="#headerregexp" title="Permanent link">&para;</a></h2>
<p>A header key and a regular expression, where the key must be present
in the request and one of the associated values must match the
expression.</p>
<p>Parameters:</p>
<ul>
<li>HeaderRegexp (string, regex)</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>HeaderRegexp(&quot;X-Forwarded-For&quot;, &quot;^192\.168\.0\.[0-2]?[0-9]?[0-9] &quot;)
HeaderRegexp(&quot;Accept&quot;, &quot;application/(json|xml)&quot;)
</code></pre></div>
<h2 id="cookie">Cookie<a class="headerlink" href="#cookie" title="Permanent link">&para;</a></h2>
<p>Matches if the specified cookie is set in the request.</p>
<p>Parameters:</p>
<ul>
<li>Cookie (string, regex) name and value match</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>Cookie(&quot;alpha&quot;, /^enabled$/)
</code></pre></div>
<h2 id="auth">Auth<a class="headerlink" href="#auth" title="Permanent link">&para;</a></h2>
<p>Authorization header based match.</p>
<h3 id="jwtpayloadanykv">JWTPayloadAnyKV<a class="headerlink" href="#jwtpayloadanykv" title="Permanent link">&para;</a></h3>
<p>Match the route if at least one of the base64 decoded JWT content
matches the key value configuration.</p>
<p>Parameters:</p>
<ul>
<li>Key-Value pairs (&hellip;string), odd index is the key of the JWT
  content and even index is the value of the JWT content</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>JWTPayloadAnyKV(&quot;iss&quot;, &quot;https://accounts.google.com&quot;)
JWTPayloadAnyKV(&quot;iss&quot;, &quot;https://accounts.google.com&quot;, &quot;email&quot;, &quot;skipper-router@googlegroups.com&quot;)
</code></pre></div>
<h3 id="jwtpayloadallkv">JWTPayloadAllKV<a class="headerlink" href="#jwtpayloadallkv" title="Permanent link">&para;</a></h3>
<p>Match the route if all of the base64 decoded JWT content
matches the key value configuration.</p>
<p>Parameters:</p>
<ul>
<li>Key-Value pairs (&hellip;string), odd index is the key of the JWT
  content and even index is the value of the JWT content</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>JWTPayloadAllKV(&quot;iss&quot;, &quot;https://accounts.google.com&quot;)
JWTPayloadAllKV(&quot;iss&quot;, &quot;https://accounts.google.com&quot;, &quot;email&quot;, &quot;skipper-router@googlegroups.com&quot;)
</code></pre></div>
<h3 id="jwtpayloadanykvregexp-jwtpayloadallkvregexp">JWTPayloadAnyKVRegexp, JWTPayloadAllKVRegexp<a class="headerlink" href="#jwtpayloadanykvregexp-jwtpayloadallkvregexp" title="Permanent link">&para;</a></h3>
<p>Behaves exactly the same as <code>JWTPayloadAnyKV</code>, <code>JWTPayloadAllKV</code>,
but the expected values are regular expressions that will be matched
against the JWT value.</p>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>JWTPayloadAllKVRegexp(&quot;iss&quot;, &quot;^https://&quot;)
JWTPayloadAnyKVRegexp(&quot;iss&quot;, &quot;^https://&quot;)
</code></pre></div>
<h3 id="headersha256">HeaderSHA256<a class="headerlink" href="#headersha256" title="Permanent link">&para;</a></h3>
<p>Matches if SHA-256 hash of the header value (known as <a href="https://en.wikipedia.org/wiki/Pre-shared_key">pre-shared key</a> or secret)
equals to any of the configured hash values.
Several hash values could be used to match multiple secrets e.g. during secret rotation.</p>
<p>Hash values only hide secrets from parties that have access to the source of Skipper routes.
Authentication strength depends on the strength of the secret value so e.g.
<code>HeaderSHA256("X-Secret", "2bb80d537b1da3e38bd30361aa855686bde0eacd7162fef6a25fe97bf527a25b")</code>
is not stronger than just <code>Header("X-Secret", "secret")</code>.</p>
<p>The secret value must be kept secret, must be used by a single client and must be rotated periodically.
See below how to generate random secret value using <a href="https://www.openssl.org/docs/man1.1.1/man1/rand.html">OpenSSL</a>.</p>
<p>Parameters:</p>
<ul>
<li>header name (string)</li>
<li>one or more hex-encoded SHA-256 hashes of the matching header values (string)</li>
</ul>
<p>Secure secret value example:
<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># 1. Generate cryptographically secure pseudo random secret header value:</span>
<span class="c1"># - length of at least 32 bytes (the size of the SHA-256 output)</span>
<span class="c1"># - encode as -base64 or -hex to get ASCII text value</span>
<span class="c1">#</span>
<span class="nv">SECRET</span><span class="o">=</span><span class="k">$(</span>openssl rand -base64 <span class="m">32</span><span class="k">)</span>
<span class="nb">echo</span> <span class="nv">$SECRET</span>
3YchPsliGjBXvyl/ncLWEI8/loKGrj/VNM4garxWEmA<span class="o">=</span>

<span class="c1">#</span>
<span class="c1"># 2. Get SHA-256 hash of the secret header value to use as HeaderSHA256 argument:</span>
<span class="c1"># - use echo -n to not output the trailing newline</span>
<span class="c1">#</span>
<span class="nb">echo</span> -n <span class="nv">$SECRET</span> <span class="p">|</span> sha256sum
a6131ba920df753c8109500cc11818f7192336d06532f6fa13009c2e4f6e1841  -
</code></pre></div>
<div class="highlight"><pre><span></span><code>// 3. Configure route to match hash of the secret value
HeaderSHA256(
    &quot;X-Secret&quot;,
    &quot;a6131ba920df753c8109500cc11818f7192336d06532f6fa13009c2e4f6e1841&quot;
) -&gt; inlineContent(&quot;ok\n&quot;) -&gt; &lt;shunt&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># 4. Test secret value</span>
curl -H <span class="s2">&quot;X-Secret: </span><span class="nv">$SECRET</span><span class="s2">&quot;</span> http://localhost:9090
</code></pre></div></p>
<p>Secret rotation example:
<div class="highlight"><pre><span></span><code>// To rotate secret:
// * add new secret - both old and new secrets match during rotation
// * update client to use new secret
// * remove old secret
HeaderSHA256(
    &quot;X-Secret&quot;,
    &quot;cba06b5736faf67e54b07b561eae94395e774c517a7d910a54369e1263ccfbd4&quot;, // SHA256(&quot;old&quot;)
    &quot;11507a0e2f5e69d5dfa40a62a1bd7b6ee57e6bcd85c67c9b8431b36fff21c437&quot;  // SHA256(&quot;new&quot;)
) -&gt; inlineContent(&quot;ok\n&quot;) -&gt; &lt;shunt&gt;
</code></pre></div></p>
<p><a href="https://en.wikipedia.org/wiki/Basic_access_authentication">Basic access authentication</a> example:
<div class="highlight"><pre><span></span><code>anon: * -&gt; setResponseHeader(&quot;WWW-Authenticate&quot;, `Basic realm=&quot;foo&quot;, charset=&quot;UTF-8&quot;`) -&gt; status(401) -&gt; &lt;shunt&gt;;
auth: HeaderSHA256(
    &quot;Authorization&quot;,
    &quot;caae07e42ed8d231a58edcde95782b0feb67186172c18c89894ce4c2174df137&quot;, // SHA256(&quot;Basic &quot; + BASE64(&quot;test:123£&quot;))
    &quot;157da8472590f0ce0a7c651bd79aecb5cc582944fcf76cbabada915d333deee8&quot;  // SHA256(&quot;Basic &quot; + BASE64(&quot;Aladdin:open sesame&quot;))
) -&gt; inlineContent(&quot;ok\n&quot;) -&gt; &lt;shunt&gt;;
</code></pre></div></p>
<h2 id="interval">Interval<a class="headerlink" href="#interval" title="Permanent link">&para;</a></h2>
<p>An interval implements custom predicates to match routes only during some period of time.</p>
<p>There are three predicates: Between, Before and After. All
predicates can be created using the date represented as:
* a string in RFC3339 format (see <a href="https://golang.org/pkg/time/#pkg-constants">https://golang.org/pkg/time/#pkg-constants</a>)
* a string in RFC3339 format without numeric timezone offset and a location name corresponding to a file in the IANA Time Zone database
* an <code>int64</code> or <code>float64</code> number corresponding to the given Unix time in seconds since January 1, 1970 UTC. <code>float64</code> number will be converted into <code>int64</code> number</p>
<h3 id="after">After<a class="headerlink" href="#after" title="Permanent link">&para;</a></h3>
<p>Matches if the request is after the specified time</p>
<p>Parameters:</p>
<ul>
<li>After (string) RFC3339 datetime string</li>
<li>After (string, string) RFC3339 datetime string without timezone offset, location name</li>
<li>After (int) unixtime in seconds</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>After(&quot;2016-01-01T12:00:00+02:00&quot;)
After(&quot;2021-02-18T00:00:00&quot;, &quot;Europe/Berlin&quot;)
After(1451642400)
</code></pre></div>
<h3 id="before">Before<a class="headerlink" href="#before" title="Permanent link">&para;</a></h3>
<p>Matches if the request is before the specified time</p>
<p>Parameters:</p>
<ul>
<li>Before (string) RFC3339 datetime string</li>
<li>Before (string, string) RFC3339 datetime string without timezone offset, location name</li>
<li>Before (int) unixtime in seconds</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>Before(&quot;2016-01-01T12:00:00+02:00&quot;)
Before(&quot;2021-02-18T00:00:00&quot;, &quot;Europe/Berlin&quot;)
Before(1451642400)
</code></pre></div>
<h3 id="between">Between<a class="headerlink" href="#between" title="Permanent link">&para;</a></h3>
<p>Matches if the request is between the specified timeframe</p>
<p>Parameters:</p>
<ul>
<li>Between (string, string) RFC3339 datetime string, from - till</li>
<li>Between (string, string, string) RFC3339 datetime string without timezone offset, from - till and a location name</li>
<li>Between (int, int) unixtime in seconds, from - till</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>Between(&quot;2016-01-01T12:00:00+02:00&quot;, &quot;2016-02-01T12:00:00+02:00&quot;)
Between(&quot;2021-02-18T00:00:00&quot;, &quot;2021-02-18T01:00:00&quot;, &quot;Europe/Berlin&quot;)
Between(1451642400, 1454320800)
</code></pre></div>
<h2 id="cron">Cron<a class="headerlink" href="#cron" title="Permanent link">&para;</a></h2>
<p>Matches routes when the given cron-like expression matches the system time.</p>
<p>Parameters:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Cron#CRON_expression">Cron</a>-like expression. See <a href="https://godoc.org/github.com/sarslanhan/cronmask#New">the package documentation</a> for supported &amp; unsupported features. Expressions are expected to be in the same time zone as the system that generates the <code>time.Time</code> instances.</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>// match everything
Cron(&quot;* * * * *&quot;)
// match only when the hour is between 5-7 (inclusive)
Cron(&quot;* 5-7, * * *&quot;)
// match only when the hour is between 5-7, equal to 8, or betweeen 12-15
Cron(&quot;* 5-7,8,12-15 * * *&quot;)
// match only when it is weekdays
Cron(&quot;* * * * 1-5&quot;)
// match only when it is weekdays &amp; working hours
Cron(&quot;* 7-18 * * 1-5&quot;)
</code></pre></div>
<h2 id="queryparam">QueryParam<a class="headerlink" href="#queryparam" title="Permanent link">&para;</a></h2>
<p>Match request based on the Query Params in URL</p>
<p>Parameters:</p>
<ul>
<li>QueryParam (string) name</li>
<li>QueryParam (string, regex) name and value match</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>// matches http://example.org?bb=a&amp;query=withvalue
QueryParam(&quot;query&quot;)

// Even a query param without a value
// matches http://example.org?bb=a&amp;query=
QueryParam(&quot;query&quot;)

// matches with regexp
// matches http://example.org?bb=a&amp;query=example
QueryParam(&quot;query&quot;, &quot;^example$&quot;)

// matches with regexp and multiple values of query param
// matches http://example.org?bb=a&amp;query=testing&amp;query=example
QueryParam(&quot;query&quot;, &quot;^example$&quot;)
</code></pre></div>
<h2 id="source">Source<a class="headerlink" href="#source" title="Permanent link">&para;</a></h2>
<p>Source implements a custom predicate to match routes based on
the source IP or X-Forwarded-For header of a request.</p>
<p>Parameters:</p>
<ul>
<li>Source (string, ..) varargs with IPs or CIDR</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>// only match requests from 1.2.3.4
Source(&quot;1.2.3.4&quot;)

// only match requests from 1.2.3.0 - 1.2.3.255
Source(&quot;1.2.3.0/24&quot;)

// only match requests from 1.2.3.4 and the 2.2.2.0/24 network
Source(&quot;1.2.3.4&quot;, &quot;2.2.2.0/24&quot;)
</code></pre></div>
<h3 id="sourcefromlast">SourceFromLast<a class="headerlink" href="#sourcefromlast" title="Permanent link">&para;</a></h3>
<p>The same as <a href="#source">Source</a>, but use the last part of the
X-Forwarded-For header to match the network. This seems to be only
used in the popular loadbalancers from AWS, ELB and ALB, because they
put the client-IP as last part of the X-Forwarded-For headers.</p>
<p>Parameters:</p>
<ul>
<li>SourceFromLast (string, ..) varargs with IPs or CIDR</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>SourceFromLast(&quot;1.2.3.4&quot;, &quot;2.2.2.0/24&quot;)
</code></pre></div>
<h2 id="clientip">ClientIP<a class="headerlink" href="#clientip" title="Permanent link">&para;</a></h2>
<p>ClientIP implements a custom predicate to match routes based on
the client IP of a request.</p>
<p>Parameters:</p>
<ul>
<li>ClientIP (string, ..) varargs with IPs or CIDR</li>
</ul>
<p>Examples:</p>
<div class="highlight"><pre><span></span><code>// only match requests from 1.2.3.4
ClientIP(&quot;1.2.3.4&quot;)

// only match requests from 1.2.3.0 - 1.2.3.255
ClientIP(&quot;1.2.3.0/24&quot;)

// only match requests from 1.2.3.4 and the 2.2.2.0/24 network
ClientIP(&quot;1.2.3.4&quot;, &quot;2.2.2.0/24&quot;)
</code></pre></div>
<h2 id="tee">Tee<a class="headerlink" href="#tee" title="Permanent link">&para;</a></h2>
<p>The Tee predicate matches a route when a request is spawn from the
<a href="../filters/#teeloopback">teeLoopback</a> filter as a tee request, using
the same provided label.</p>
<p>Parameters:</p>
<ul>
<li>tee label (string): the predicate will match only those requests that
  were spawn from a teeLoopback filter using the same label.</li>
</ul>
<p>See also:</p>
<ul>
<li><a href="../filters/#teeloopback">teeLoopback filter</a></li>
<li><a href="../../tutorials/shadow-traffic/">Shadow Traffic Tutorial</a></li>
</ul>
<h2 id="traffic">Traffic<a class="headerlink" href="#traffic" title="Permanent link">&para;</a></h2>
<p>Traffic implements a predicate to control the matching probability for
a given route by setting its weight.</p>
<p>The probability for matching a route is defined by the mandatory first
parameter, that must be a decimal number between 0.0 and 1.0 (both
inclusive).</p>
<p>The optional second argument is used to specify the cookie name for
the traffic group, in case you want to use stickiness. Stickiness
allows all subsequent requests from the same client to match the same
route. Stickiness of traffic is supported by the optional third
parameter, indicating whether the request being matched belongs to the
traffic group of the current route. If yes, the predicate matches
ignoring the chance argument.</p>
<p>Parameters:</p>
<ul>
<li>Traffic (decimal) valid values [0.0, 1.0]</li>
<li>Traffic (decimal, string, string) session stickyness</li>
</ul>
<p>Examples:</p>
<p>non-sticky:</p>
<div class="highlight"><pre><span></span><code>// hit by 10% percent chance
v2:
    Traffic(.1) -&gt;
    &quot;https://api-test-green&quot;;

// hit by remaining chance
v1:
    * -&gt;
    &quot;https://api-test-blue&quot;;
</code></pre></div>
<p>stickyness:</p>
<div class="highlight"><pre><span></span><code>// hit by 5% percent chance
cartTest:
    Traffic(.05, &quot;cart-test&quot;, &quot;test&quot;) &amp;&amp; Path(&quot;/cart&quot;) -&gt;
    responseCookie(&quot;cart-test&quot;, &quot;test&quot;) -&gt;
    &quot;https://cart-test&quot;;

// hit by remaining chance
cart:
    Path(&quot;/cart&quot;) -&gt;
    responseCookie(&quot;cart-test&quot;, &quot;default&quot;) -&gt;
    &quot;https://cart&quot;;

// hit by 15% percent chance
catalogTestA:
    Traffic(.15, &quot;catalog-test&quot;, &quot;A&quot;) -&gt;
    responseCookie(&quot;catalog-test&quot;, &quot;A&quot;) -&gt;
    &quot;https://catalog-test-a&quot;;

// hit by 30% percent chance
catalogTestB:
    Traffic(.3, &quot;catalog-test&quot;, &quot;B&quot;) -&gt;
    responseCookie(&quot;catalog-test&quot;, &quot;B&quot;) -&gt;
    &quot;https://catalog-test-b&quot;;

// hit by remaining chance
catalog:
    * -&gt;
    responseCookie(&quot;catalog-test&quot;, &quot;default&quot;) -&gt;
    &quot;https://catalog&quot;;
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../filters/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Filters
              </div>
            </div>
          </a>
        
        
          <a href="../backends/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Backends
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>