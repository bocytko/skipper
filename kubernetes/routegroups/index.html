
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="canonical" href="https://opensource.zalando.com/skipper/kubernetes/routegroups/">
      
      <link rel="shortcut icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.5">
    
    
      
        <title>RouteGroups - Skipper</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.15aa0b43.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.75751829.min.css">
        
          
          
          <meta name="theme-color" content="#ffffff">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="white" data-md-color-accent="">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#route-groups" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://opensource.zalando.com/skipper/" title="Skipper" class="md-header-nav__button md-logo" aria-label="Skipper">
      
  <img src="../../skipper-h180.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Skipper
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              RouteGroups
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/zalando/skipper/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://opensource.zalando.com/skipper/" title="Skipper" class="md-nav__button md-logo" aria-label="Skipper">
      
  <img src="../../skipper-h180.png" alt="logo">

    </a>
    Skipper
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/zalando/skipper/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" >
      
      <label class="md-nav__link" for="nav-2">
        Reference
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/filters/" class="md-nav__link">
        Filters
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/predicates/" class="md-nav__link">
        Predicates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/backends/" class="md-nav__link">
        Backends
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/egress/" class="md-nav__link">
        Egress
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/scripts/" class="md-nav__link">
        Scripts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/development/" class="md-nav__link">
        Development
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/video-howto-build/" class="md-nav__link">
        Video - How to build
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10" >
      
      <label class="md-nav__link" for="nav-2-10">
        Data Clients
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Data Clients" data-md-level="2">
        <label class="md-nav__title" for="nav-2-10">
          <span class="md-nav__icon md-icon"></span>
          Data Clients
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data-clients/eskip-file/" class="md-nav__link">
        Eskip File
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data-clients/eskip-remote/" class="md-nav__link">
        Remote Eskip
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data-clients/route-string/" class="md-nav__link">
        Route String
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data-clients/kubernetes/" class="md-nav__link">
        Kubernetes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../data-clients/etcd/" class="md-nav__link">
        Etcd
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-11" type="checkbox" id="nav-2-11" >
      
      <label class="md-nav__link" for="nav-2-11">
        Operation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Operation" data-md-level="2">
        <label class="md-nav__title" for="nav-2-11">
          <span class="md-nav__icon md-icon"></span>
          Operation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/deployment/" class="md-nav__link">
        Deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/operation/" class="md-nav__link">
        Operation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
      
      <label class="md-nav__link" for="nav-3">
        Kubernetes
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Kubernetes" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ingress-controller/" class="md-nav__link">
        Ingress Controller Deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ingress-usage/" class="md-nav__link">
        Ingress Usage
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ingress-backends/" class="md-nav__link">
        Ingress Backends
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          RouteGroups
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        RouteGroups
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skipper-as-kubernetes-ingress-controller" class="md-nav__link">
    Skipper as Kubernetes Ingress controller
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routegroups" class="md-nav__link">
    RouteGroups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hosts" class="md-nav__link">
    Hosts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backends" class="md-nav__link">
    Backends
  </a>
  
    <nav class="md-nav" aria-label="Backends">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typeservice" class="md-nav__link">
    type=service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typelb" class="md-nav__link">
    type=lb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typenetwork" class="md-nav__link">
    type=network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typeshunt-typeloopback-typedynamic" class="md-nav__link">
    type=shunt, type=loopback, type=dynamic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-backends" class="md-nav__link">
    Default Backends
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routes" class="md-nav__link">
    Routes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gradual-traffic-switching" class="md-nav__link">
    Gradual traffic switching
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-from-ingress-to-routegroups" class="md-nav__link">
    Mapping from Ingress to RouteGroups
  </a>
  
    <nav class="md-nav" aria-label="Mapping from Ingress to RouteGroups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-with-default-backend" class="md-nav__link">
    Ingress with default backend
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-with-path-rule" class="md-nav__link">
    Ingress with path rule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-with-multiple-hosts" class="md-nav__link">
    Ingress with multiple hosts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-with-multiple-hosts-and-different-routing" class="md-nav__link">
    Ingress with multiple hosts, and different routing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-skipper-ingress-extensions-to-routegroups" class="md-nav__link">
    Mapping Skipper Ingress extensions to RouteGroups
  </a>
  
    <nav class="md-nav" aria-label="Mapping Skipper Ingress extensions to RouteGroups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zalandoorgbackend-weights" class="md-nav__link">
    zalando.org/backend-weights
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-filter-and-zalandoorgskipper-predicate" class="md-nav__link">
    zalando.org/skipper-filter and zalando.org/skipper-predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-routes" class="md-nav__link">
    zalando.org/skipper-routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgratelimit" class="md-nav__link">
    zalando.org/ratelimit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-ingress-redirect-and-zalandoorgskipper-ingress-redirect-code" class="md-nav__link">
    zalando.org/skipper-ingress-redirect and zalando.org/skipper-ingress-redirect-code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-loadbalancer" class="md-nav__link">
    zalando.org/skipper-loadbalancer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-ingress-path-mode" class="md-nav__link">
    zalando.org/skipper-ingress-path-mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-skipper-deployments" class="md-nav__link">
    Multiple skipper deployments
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../routegroup-crd/" class="md-nav__link">
        RouteGroup CRD Semantics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../routegroup-validation/" class="md-nav__link">
        RouteGroup Validation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../east-west-usage/" class="md-nav__link">
        East-West aka svc-to-svc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../external-addresses/" class="md-nav__link">
        External Addresses aka External Name
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      


  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" >
      
      <label class="md-nav__link" for="nav-4">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="nav-4">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/basics/" class="md-nav__link">
        Basics
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/common-use-cases/" class="md-nav__link">
        Common Use Cases
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/auth/" class="md-nav__link">
        Authentication and Autorization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/ratelimit/" class="md-nav__link">
        Ratelimits
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/shadow-traffic/" class="md-nav__link">
        Shadow Traffic
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/operations/" class="md-nav__link">
        Operations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/development/" class="md-nav__link">
        Development
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#skipper-as-kubernetes-ingress-controller" class="md-nav__link">
    Skipper as Kubernetes Ingress controller
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routegroups" class="md-nav__link">
    RouteGroups
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hosts" class="md-nav__link">
    Hosts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backends" class="md-nav__link">
    Backends
  </a>
  
    <nav class="md-nav" aria-label="Backends">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#typeservice" class="md-nav__link">
    type=service
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typelb" class="md-nav__link">
    type=lb
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typenetwork" class="md-nav__link">
    type=network
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typeshunt-typeloopback-typedynamic" class="md-nav__link">
    type=shunt, type=loopback, type=dynamic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-backends" class="md-nav__link">
    Default Backends
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#routes" class="md-nav__link">
    Routes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gradual-traffic-switching" class="md-nav__link">
    Gradual traffic switching
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-from-ingress-to-routegroups" class="md-nav__link">
    Mapping from Ingress to RouteGroups
  </a>
  
    <nav class="md-nav" aria-label="Mapping from Ingress to RouteGroups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ingress-with-default-backend" class="md-nav__link">
    Ingress with default backend
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-with-path-rule" class="md-nav__link">
    Ingress with path rule
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-with-multiple-hosts" class="md-nav__link">
    Ingress with multiple hosts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress-with-multiple-hosts-and-different-routing" class="md-nav__link">
    Ingress with multiple hosts, and different routing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mapping-skipper-ingress-extensions-to-routegroups" class="md-nav__link">
    Mapping Skipper Ingress extensions to RouteGroups
  </a>
  
    <nav class="md-nav" aria-label="Mapping Skipper Ingress extensions to RouteGroups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zalandoorgbackend-weights" class="md-nav__link">
    zalando.org/backend-weights
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-filter-and-zalandoorgskipper-predicate" class="md-nav__link">
    zalando.org/skipper-filter and zalando.org/skipper-predicate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-routes" class="md-nav__link">
    zalando.org/skipper-routes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgratelimit" class="md-nav__link">
    zalando.org/ratelimit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-ingress-redirect-and-zalandoorgskipper-ingress-redirect-code" class="md-nav__link">
    zalando.org/skipper-ingress-redirect and zalando.org/skipper-ingress-redirect-code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-loadbalancer" class="md-nav__link">
    zalando.org/skipper-loadbalancer
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zalandoorgskipper-ingress-path-mode" class="md-nav__link">
    zalando.org/skipper-ingress-path-mode
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multiple-skipper-deployments" class="md-nav__link">
    Multiple skipper deployments
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/zalando/skipper/edit/master/docs/kubernetes/routegroups.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="route-groups">Route groups<a class="headerlink" href="#route-groups" title="Permanent link">&para;</a></h1>
<p>Route groups are an alternative to the Kubernetes Ingress format for defining ingress rules. They allow to
define Skipper routing in Kubernetes, while providing a straightforward way to configure the routing features
supported by Skipper and not defined by the generic Ingress.</p>
<h2 id="skipper-as-kubernetes-ingress-controller">Skipper as Kubernetes Ingress controller<a class="headerlink" href="#skipper-as-kubernetes-ingress-controller" title="Permanent link">&para;</a></h2>
<p>Skipper is an extensible HTTP router with rich route matching, and request flow and traffic shaping
capabilities. Through its integration with Kubernetes, it can be used in the role of an ingress controller for
forwarding incoming external requests to the right services in a cluster. Kubernetes provides the Ingress
specification to define the rules by which an ingress controller should handle the incoming traffic. The
specification is simple and generic, but doesn&rsquo;t offer a straightforward way to benefit from Skipper&rsquo;s rich HTTP
related functionality.</p>
<h2 id="routegroups">RouteGroups<a class="headerlink" href="#routegroups" title="Permanent link">&para;</a></h2>
<p>A RouteGroup is a custom Kubernetes resource definition. It provides a way to define the ingress routing for
Kubernetes services. It allows route matching based on any HTTP request attributes, and provides a clean way for
the request flow augmentation and traffic shaping. It supports higher level features like gradual traffic
switching, A/B testing, and more.</p>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-routes</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-a</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service-a</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-b</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service-b</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">defaultBackends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-b</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">responseCookie(&quot;canary&quot;, &quot;A&quot;)</span>
    <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Traffic(.1)</span>
    <span class="nt">backends</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-a</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">responseCookie(&quot;canary&quot;, &quot;B&quot;)</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Cookie(&quot;canary&quot;, &quot;A&quot;)</span>
    <span class="nt">backends</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-a</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Cookie(&quot;canary&quot;, &quot;B&quot;)</span>
</code></pre></div>
<p>(See a more detailed explanation of the above example <a href="#gradual-traffic-switching">further down</a> in this
document.)</p>
<p>Links:</p>
<ul>
<li><a href="../routegroup-crd/">RouteGroup semantics</a></li>
<li><a href="https://github.com/zalando/skipper/blob/master/dataclients/kubernetes/deploy/apply/routegroups_crd.yaml">CRD definition</a></li>
</ul>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/kubernetes-sigs/external-dns/releases/tag/v0.7.0">External DNS v0.7.0 or higher</a></li>
<li><a href="https://github.com/zalando-incubator/kube-ingress-aws-controller/releases/tag/v0.10.0">Kubernetes Ingress Controller for AWS v0.10.0 or higher</a></li>
</ul>
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>The definition file of the CRD can be found as part of Skipper&rsquo;s source code, at:</p>
<p><a href="https://github.com/zalando/skipper/blob/master/dataclients/kubernetes/deploy/apply/routegroups_crd.yaml">https://github.com/zalando/skipper/blob/master/dataclients/kubernetes/deploy/apply/routegroups_crd.yaml</a></p>
<p>To install it manually in a cluster, assuming the current directory is the root of Skipper&rsquo;s source, call this
command:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f dataclients/kubernetes/deploy/apply/routegroups_crd.yaml
</code></pre></div>
<p>This will install a namespaced resource definition, providing the RouteGroup kind:</p>
<ul>
<li>full name: routegroups.zalando.org</li>
<li>resource group: zalando.org/v1</li>
<li>resource names: routegroup, routegroups, rg, rgs</li>
<li>kind: RouteGroup</li>
</ul>
<p>The route groups, once any is defined, can be displayed then via kubectl as:</p>
<div class="highlight"><pre><span></span><code>kubectl get rgs
</code></pre></div>
<p>The API URL of the routegroup resources will be:</p>
<p><a href="https://kubernetes-api-hostname/apis/zalando.org/v1/routegroups">https://kubernetes-api-hostname/apis/zalando.org/v1/routegroups</a></p>
<h2 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h2>
<p>The absolute minimal route group configuration for a Kubernetes service (my-service) looks as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">routes</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
      <span class="nt">backends</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
</code></pre></div>
<p>This is equivalent to the ingress:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">defaultBackend</span><span class="p">:</span>
    <span class="nt">service</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
      <span class="nt">port</span><span class="p">:</span>
        <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>Notice that the route group contains a list of actual backends, and the defined service backend is then
referenced as the default backend. This structure plays a role in supporting scenarios like A/B testing and
gradual traffic switching, <a href="#gradual-traffic-switching">explained below</a>. The backend definition also has a type
field, whose values can be service, lb, network, shunt, loopback or dynamic. More details on that
<a href="#backends">below</a>.</p>
<p>Creating, updating and deleting route groups happens the same way as with ingress objects. E.g, manually
applying a route group definition:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f my-route-group.yaml
</code></pre></div>
<h2 id="hosts">Hosts<a class="headerlink" href="#hosts" title="Permanent link">&para;</a></h2>
<ul>
<li><em><a href="../routegroup-crd/#routegroup-top-level-object">Format</a></em></li>
</ul>
<p>Hosts contain hostnames that are used to match the requests handled by a given route group. They are also used
to update the required DNS entries and load balancer configuration if the cluster is set up that way.</p>
<p>Note that it is also possible to use any Skipper predicate in the routes of a route group, with the Host
predicate included, but the hostnames defined that way will not serve as input for the DNS configuration.</p>
<h2 id="backends">Backends<a class="headerlink" href="#backends" title="Permanent link">&para;</a></h2>
<ul>
<li><em><a href="../routegroup-crd/#backend_1">Format</a></em></li>
<li><em><a href="../../reference/backends/">General backend reference</a></em></li>
</ul>
<p>RouteGroups support different backends. The most typical backend type is the &lsquo;service&rsquo;, and it works the same
way as in case of ingress definitions.</p>
<p>In a RouteGroup, there can be multiple backends and they are listed on the top level of the route group spec,
and are referenced from the actual routes or as default backends.</p>
<h3 id="typeservice">type=service<a class="headerlink" href="#typeservice" title="Permanent link">&para;</a></h3>
<p>This backend resolves to a Kubernetes service. It works the same way as in case of Ingress definitions. Skipper
resolves the Services to the available Endpoints belonging to the Service, and generates load balanced routes
using them. (This basically means that under the hood, a <code>service</code> backend becomes an <code>lb</code> backend.)</p>
<h3 id="typelb">type=lb<a class="headerlink" href="#typelb" title="Permanent link">&para;</a></h3>
<p>This backend provides load balancing between multiple network endpoints. Keep in mind that the service type
backend automatically generates load balanced routes for the service endpoints, so this backend type typically
doesn&rsquo;t need to be used for services.</p>
<h3 id="typenetwork">type=network<a class="headerlink" href="#typenetwork" title="Permanent link">&para;</a></h3>
<p>This backend type results in routes that proxy incoming requests to the defined network address, regardless of
the Kubernetes semantics, and allows URLs that point somewhere else, potentially outside of the cluster, too.</p>
<h3 id="typeshunt-typeloopback-typedynamic">type=shunt, type=loopback, type=dynamic<a class="headerlink" href="#typeshunt-typeloopback-typedynamic" title="Permanent link">&para;</a></h3>
<p>These backend types allow advanced routing setups. Please check the <a href="../../reference/backends/">reference
manual</a> for more details.</p>
<h2 id="default-backends">Default Backends<a class="headerlink" href="#default-backends" title="Permanent link">&para;</a></h2>
<ul>
<li><em><a href="../routegroup-crd/#backend-reference">Format</a></em></li>
</ul>
<p>A default backend is a reference to one of the defined backends. When a route doesn&rsquo;t specify which backend(s)
to use, the ones referenced in the default backends will be used.</p>
<p>In case there are no individual routes at all in the route group, a default set of routes (one or more) will be
generated and will proxy the incoming traffic to the default backends.</p>
<p>The reason, why multiple backends can be referenced as default, is that this makes it easy to execute gradual
traffic switching between different versions, even more than two, of the same application. <a href="#gradual-traffic-switching">See
more</a>.</p>
<h2 id="routes">Routes<a class="headerlink" href="#routes" title="Permanent link">&para;</a></h2>
<ul>
<li><em><a href="../routegroup-crd/#route_1">Format</a></em></li>
</ul>
<p>Routes define where to and how the incoming requests will be proxied. The predicates, including the path,
pathSubtree, pathRegexp and methods fields, and any free-form predicate listed under the predicates field,
control which requests are matched by a route, the filters can apply changes to the forwarded requests and the
returned responses, and the backend refs, if defined, override the default backends, where the requests will be
proxied to. If a route group doesn&rsquo;t contain any explicit routes, but it contains default backends, a default
set of routes will be generated for the route group.</p>
<p>Important to bear in mind about the path fields, that the plain &lsquo;path&rsquo; means exact path match, while
&lsquo;pathSubtree&rsquo; behaves as a path prefix, and so it is more similar to the path in the Ingress specification.</p>
<p>See also:</p>
<ul>
<li><a href="../../reference/predicates/">predicates</a></li>
<li><a href="../../reference/filters/">filters</a></li>
</ul>
<h2 id="gradual-traffic-switching">Gradual traffic switching<a class="headerlink" href="#gradual-traffic-switching" title="Permanent link">&para;</a></h2>
<p>The weighted backend references allow to split the traffic of a single route and send it to different backends
with the ratio defined by the weights of the backend references. E.g:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-routes</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api-svc-v1</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api-service-v1</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api-svc-v2</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">foo-service-v2</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
    <span class="nt">backends</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api-svc-v1</span>
      <span class="nt">weight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api-svc-v2</span>
      <span class="nt">weight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20</span>
</code></pre></div>
<p>In case of the above example, 80% of the requests is sent to api-service-v1 and the rest is sent to
api-service-v2.</p>
<p>Since this type of weighted traffic switching can be used in combination with the Traffic predicate, it is
possible to control the routing of a long running A/B test, while still executing gradual traffic switching
independently to deploy a new version of the variants, maybe to deploy a fix only to one variant. E.g:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-routes</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-a</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service-a</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-b</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service-b-v1</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-b-v2</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service-b-v2</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">defaultBackends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-b</span>
    <span class="nt">weight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-b-v2</span>
    <span class="nt">weight</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">20</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">responseCookie(&quot;canary&quot;, &quot;A&quot;)</span>
    <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Traffic(.1)</span>
    <span class="nt">backends</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-a</span>
  <span class="p p-Indicator">-</span> <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">responseCookie(&quot;canary&quot;, &quot;B&quot;)</span>
  <span class="p p-Indicator">-</span> <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Cookie(&quot;canary&quot;, &quot;A&quot;)</span>
    <span class="nt">backends</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">variant-a</span>
  <span class="p p-Indicator">-</span> <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Cookie(&quot;canary&quot;, &quot;B&quot;)</span>
</code></pre></div>
<p>See also:</p>
<ul>
<li><a href="../../reference/predicates/#traffic">Traffic predicate</a></li>
</ul>
<h2 id="mapping-from-ingress-to-routegroups">Mapping from Ingress to RouteGroups<a class="headerlink" href="#mapping-from-ingress-to-routegroups" title="Permanent link">&para;</a></h2>
<p>RouteGroups are one-way compatible with Ingress, meaning that every Ingress specification can be expressed in
the RouteGroup format, as well. In the following, we describe the mapping from Ingress fields to RouteGroup
fields.</p>
<h3 id="ingress-with-default-backend">Ingress with default backend<a class="headerlink" href="#ingress-with-default-backend" title="Permanent link">&para;</a></h3>
<p>Ingress:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">defaultBackend</span><span class="p">:</span>
    <span class="nt">service</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
      <span class="nt">port</span><span class="p">:</span>
        <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>RouteGroup:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">defaultBackends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
</code></pre></div>
<h3 id="ingress-with-path-rule">Ingress with path rule<a class="headerlink" href="#ingress-with-path-rule" title="Permanent link">&para;</a></h3>
<p>Ingress:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
    <span class="nt">http</span><span class="p">:</span>
      <span class="nt">paths</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
        <span class="nt">pathType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Prefix</span>
        <span class="nt">backend</span><span class="p">:</span>
          <span class="nt">service</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
            <span class="nt">port</span><span class="p">:</span>
              <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>RouteGroup:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
</code></pre></div>
<h3 id="ingress-with-multiple-hosts">Ingress with multiple hosts<a class="headerlink" href="#ingress-with-multiple-hosts" title="Permanent link">&para;</a></h3>
<p>Ingress (we need to define two rules):</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
    <span class="nt">http</span><span class="p">:</span>
      <span class="nt">paths</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
        <span class="nt">pathType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Prefix</span>
        <span class="nt">backend</span><span class="p">:</span>
          <span class="nt">service</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
            <span class="nt">port</span><span class="p">:</span>
              <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">legacy-name.example.org</span>
    <span class="nt">http</span><span class="p">:</span>
      <span class="nt">paths</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
        <span class="nt">pathType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Prefix</span>
        <span class="nt">backend</span><span class="p">:</span>
          <span class="nt">service</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
            <span class="nt">port</span><span class="p">:</span>
              <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>RouteGroup (we just define an additional host):</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">legacy-name.example.org</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
</code></pre></div>
<h3 id="ingress-with-multiple-hosts-and-different-routing">Ingress with multiple hosts, and different routing<a class="headerlink" href="#ingress-with-multiple-hosts-and-different-routing" title="Permanent link">&para;</a></h3>
<p>For those cases when using multiple hostnames in the same ingress with different rules, we need to apply a
small workaround for the equivalent route group spec. Ingress:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
    <span class="nt">http</span><span class="p">:</span>
      <span class="nt">paths</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
        <span class="nt">pathType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Prefix</span>
        <span class="nt">backend</span><span class="p">:</span>
          <span class="nt">service</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
            <span class="nt">port</span><span class="p">:</span>
              <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">legacy-name.example.org</span>
    <span class="nt">http</span><span class="p">:</span>
      <span class="nt">paths</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/application</span>
        <span class="nt">pathType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Prefix</span>
        <span class="nt">backend</span><span class="p">:</span>
          <span class="nt">service</span><span class="p">:</span>
            <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
            <span class="nt">port</span><span class="p">:</span>
              <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>RouteGroup (we need to use additional host predicates):</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">hosts</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">api.example.org</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">legacy-name.example.org</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/api</span>
    <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Host(&quot;api.example.org&quot;)</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/application</span>
    <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Host(&quot;legacy-name.example.org&quot;)</span>
</code></pre></div>
<p>The RouteGroups allow multiple hostnames for each route group, but by default, their union is used during
routing. If we want to distinguish between them, then we need to use an additional Host predicate in the routes.
Importantly, only the hostnames listed under the hosts field serve as input for the DNS and LB configuration.</p>
<h2 id="mapping-skipper-ingress-extensions-to-routegroups">Mapping Skipper Ingress extensions to RouteGroups<a class="headerlink" href="#mapping-skipper-ingress-extensions-to-routegroups" title="Permanent link">&para;</a></h2>
<p>Skipper accepts a set of annotations in Ingress objects that give access to certain Skipper features that would
not be possible with the native fields of the Ingress spec, e.g. improved path handling or rate limiting. These
annotations can be expressed now natively in the RouteGroups.</p>
<h3 id="zalandoorgbackend-weights">zalando.org/backend-weights<a class="headerlink" href="#zalandoorgbackend-weights" title="Permanent link">&para;</a></h3>
<p>Backend weights are now part of the backend references, and they can be controlled for multiple backend sets
within the same route group. See <a href="#gradual-traffic-switching">Gradual traffic switching</a>.</p>
<h3 id="zalandoorgskipper-filter-and-zalandoorgskipper-predicate">zalando.org/skipper-filter and zalando.org/skipper-predicate<a class="headerlink" href="#zalandoorgskipper-filter-and-zalandoorgskipper-predicate" title="Permanent link">&para;</a></h3>
<p>Filters and predicates are now part of the route objects, and different set of filters or predicates can be set
for different routes.</p>
<h3 id="zalandoorgskipper-routes">zalando.org/skipper-routes<a class="headerlink" href="#zalandoorgskipper-routes" title="Permanent link">&para;</a></h3>
<p>&ldquo;Custom routes&rdquo; in a route group are unnecessary, because every route can be configured with predicates, filters
and backends without limitations. E.g where an ingress annotation&rsquo;s metadata may look like this:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
  <span class="nt">zalando.org/skipper-routes</span><span class="p">:</span> <span class="p p-Indicator">|</span>
    <span class="no">Method(&quot;OPTIONS&quot;) -&gt; status(200) -&gt; &lt;shunt&gt;</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">backend</span><span class="p">:</span>
    <span class="nt">service</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
      <span class="nt">port</span><span class="p">:</span>
        <span class="nt">number</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>the equivalent RouteGroup would look like this:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">options200</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">shunt</span>
  <span class="nt">defaultBackends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class="nt">methods</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">OPTIONS</span>
    <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">status(200)</span>
    <span class="nt">backends</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">options200</span>
</code></pre></div>
<h3 id="zalandoorgratelimit">zalando.org/ratelimit<a class="headerlink" href="#zalandoorgratelimit" title="Permanent link">&para;</a></h3>
<p>The ratelimiting can be defined on the route level among the filters, in the same format as in this annotation.</p>
<h3 id="zalandoorgskipper-ingress-redirect-and-zalandoorgskipper-ingress-redirect-code">zalando.org/skipper-ingress-redirect and zalando.org/skipper-ingress-redirect-code<a class="headerlink" href="#zalandoorgskipper-ingress-redirect-and-zalandoorgskipper-ingress-redirect-code" title="Permanent link">&para;</a></h3>
<p>Skipper ingress provides global HTTPS redirect, but it allows individual ingresses to override the global
settings: enabling/disabling it and changing the default redirect code. With route groups, this override can be
achieved by simply defining an additional route, with the same matching rules, and therefore the override can be
controlled eventually on a route basis. E.g:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">redirectShunt</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">shunt</span>
  <span class="nt">defaultBackends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
  <span class="nt">routes</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
  <span class="p p-Indicator">-</span> <span class="nt">pathSubtree</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/</span>
    <span class="nt">predicates</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Header(&quot;X-Forwarded-Proto&quot;, &quot;http&quot;)</span>
    <span class="nt">filters</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">redirectTo(302, &quot;https:&quot;)</span>
    <span class="nt">backends</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">redirectShunt</span>
</code></pre></div>
<h3 id="zalandoorgskipper-loadbalancer">zalando.org/skipper-loadbalancer<a class="headerlink" href="#zalandoorgskipper-loadbalancer" title="Permanent link">&para;</a></h3>
<p>Skipper Ingress doesn&rsquo;t use the ClusterIP of the Service for forwarding the traffic to, but sends it directly to
the Endpoints represented by the Service, and balances the load between them with the round-robin algorithm. The
algorithm choice can be overridden by this annotation. In case of the RouteGroups, the algorithm is simply an
attribute of the backend definition, and it can be set individually for each backend. E.g:</p>
<div class="highlight"><pre><span></span><code>  backends:
  - name: my-backend
    type: service
    serviceName: my-service
    servicePort: 80
    algorithm: consistentHash
</code></pre></div>
<p>See also:</p>
<ul>
<li><a href="../../reference/backends/#load-balancer-backend">Load Balancer backend</a></li>
</ul>
<h3 id="zalandoorgskipper-ingress-path-mode">zalando.org/skipper-ingress-path-mode<a class="headerlink" href="#zalandoorgskipper-ingress-path-mode" title="Permanent link">&para;</a></h3>
<p>The route objects support the different path lookup modes, by using the path, pathSubtree or the
pathRegexp field. See also the <a href="../../reference/architecture/#route-matching">route matching</a>
explained for the internals. The mapping is as follows:</p>
<table>
<thead>
<tr>
<th>Ingress pathType:</th>
<th>RouteGroup:</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Exact</code> and <code>/foo</code></td>
<td>path: <code>/foo</code></td>
</tr>
<tr>
<td><code>Prefix</code> and <code>/foo</code></td>
<td>pathSubtree: <code>/foo</code></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Ingress (<code>pathType: ImplementationSpecific</code>):</th>
<th>RouteGroup:</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>kubernetes-ingress</code> and <code>/foo</code></td>
<td>pathRegexp: <code>^/foo</code></td>
</tr>
<tr>
<td><code>path-regexp</code> and <code>/foo</code></td>
<td>pathRegexp: <code>/foo</code></td>
</tr>
<tr>
<td><code>path-prefix</code> and <code>/foo</code></td>
<td>pathSubtree: <code>/foo</code></td>
</tr>
<tr>
<td><code>kubernetes-ingress</code> and /foo$</td>
<td>path: <code>/foo</code></td>
</tr>
</tbody>
</table>
<h2 id="multiple-skipper-deployments">Multiple skipper deployments<a class="headerlink" href="#multiple-skipper-deployments" title="Permanent link">&para;</a></h2>
<p>If you want to split for example <code>internal</code> and <code>public</code> traffic, it
might be a good choice to split your RouteGroups. Skipper has
the flag <code>--kubernetes-routegroup-class=&lt;string&gt;</code> to only select RouteGroup
objects that have the annotation <code>zalando.org/routegroup.class</code> set to
<code>&lt;string&gt;</code>. Skipper will only create routes for RouteGroup objects with
it&rsquo;s annotation or RouteGroup objects that do not have this annotation. The
default class is <code>skipper</code>, if not set.</p>
<p>Example RouteGroup:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">zalando.org/v1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RouteGroup</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-route-group</span>
  <span class="nt">annotations</span><span class="p">:</span>
    <span class="nt">zalando.org/routegroup.class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">internal</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">backends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-backend</span>
    <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">service</span>
    <span class="nt">serviceName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
    <span class="nt">servicePort</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">80</span>
  <span class="nt">defaultBackends</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">backendName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">my-service</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../ingress-backends/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Ingress Backends
              </div>
            </div>
          </a>
        
        
          <a href="../routegroup-crd/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                RouteGroup CRD Semantics
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.93c04032.min.js"></script>
      <script src="../../assets/javascripts/bundle.83e5331e.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.8c7e0a7e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>